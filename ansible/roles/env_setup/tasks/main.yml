---
# Temporary environment setup for installation phase

- name: Create temporary environment setup for bash
  ansible.builtin.blockinfile:
    path: "{{ ansible_user_dir }}/.bashrc"
    marker: "# {mark} ANSIBLE MANAGED BLOCK - TEMP ENV (will be replaced by chezmoi)"
    block: |
      # Temporary environment setup for installation phase
      # This will be replaced when chezmoi applies final config

      # Cargo/Rust
      [ -f "$HOME/.cargo/env" ] && source "$HOME/.cargo/env"

      # Go
      export GOPATH="$HOME/go"
      export PATH="$GOPATH/bin:$PATH"

      # UV tools
      export PATH="$HOME/.local/bin:$PATH"
    create: true
    mode: "0644"

- name: Set unified PATH fact for Ansible tasks
  ansible.builtin.set_fact:
    ansible_path: "{{ brew_prefix }}/bin:{{ ansible_user_dir }}/.cargo/bin:{{ ansible_user_dir }}/go/bin:{{ ansible_user_dir }}/.local/bin:{{ ansible_env.PATH }}"

- name: Display configured PATH
  ansible.builtin.debug:
    msg: "Unified PATH for package installation: {{ ansible_path }}"
