---
# Install packages via Homebrew

- name: Install packages via Homebrew
  community.general.homebrew:
    name: "{{ brew_packages }}"
    state: present
    install_options: ["quiet"]
    path: "{{ brew_bin }}"
  environment:
    PATH: "{{ ansible_path | default(ansible_facts['env']['PATH']) }}"
  register: brew_updates
  when: not ansible_check_mode

- name: Show changed packages # noqa: no-handler
  ansible.builtin.debug:
    var: brew_updates.changed_pkgs
  when: brew_updates.changed_pkgs | default([]) | length > 0
