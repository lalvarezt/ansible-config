---
# Fedora-specific terminal emulator installation

# Kitty - available in Fedora repos
- name: Install kitty via dnf
  ansible.builtin.dnf:
    name: kitty
    state: present
  become: true
  register: kitty_result
  failed_when: false

# WezTerm - install via COPR (official method)
- name: Check if wezterm is installed
  ansible.builtin.command: which wezterm
  register: wezterm_check
  failed_when: false
  changed_when: false

- name: Install WezTerm via COPR
  when: wezterm_check.rc != 0
  block:
    - name: Enable WezTerm COPR repository
      ansible.builtin.command: dnf copr enable -y wezfurlong/wezterm-nightly
      become: true
      changed_when: true

    - name: Install wezterm
      ansible.builtin.dnf:
        name: wezterm
        state: present
      become: true

# Ghostty - install via COPR
- name: Check if ghostty is installed
  ansible.builtin.command: which ghostty
  register: ghostty_check
  failed_when: false
  changed_when: false

- name: Install Ghostty via COPR
  when: ghostty_check.rc != 0
  block:
    - name: Add Ghostty COPR repository
      ansible.builtin.get_url:
        url: "https://copr.fedorainfracloud.org/coprs/scottames/ghostty/repo/fedora-{{ ansible_distribution_major_version }}/scottames-ghostty-fedora-{{ ansible_distribution_major_version
          }}.repo"
        dest: "/etc/yum.repos.d/ghostty.repo"
        mode: "0644"
      become: true

    - name: Install ghostty
      ansible.builtin.dnf:
        name: ghostty
        state: present
      become: true
