---
# Main task file for system prerequisites

- name: Detect if running on WSL
  ansible.builtin.command: grep -qi microsoft /proc/version
  register: wsl_check
  failed_when: false
  changed_when: false

- name: Set WSL fact
  ansible.builtin.set_fact:
    is_wsl: "{{ wsl_check.rc == 0 }}"

- name: Include distro-specific prerequisites
  ansible.builtin.include_tasks: "{{ ansible_facts['distribution'] | lower }}.yml"
  when: ansible_facts['distribution'] | lower in ['ubuntu', 'fedora', 'archlinux', 'endeavouros']

- name: Display system information
  ansible.builtin.debug:
    msg: "Detected {{ ansible_facts['distribution'] }} {{ ansible_facts['distribution_version'] }}, WSL: {{ is_wsl }}"
