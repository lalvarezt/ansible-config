---
# Arch Linux-specific system prerequisites

- name: Detect available package manager for Arch
  ansible.builtin.shell: |
    if command -v yay >/dev/null 2>&1; then
      echo "yay"
    else
      echo "pacman"
    fi
  register: arch_pkg_mgr
  changed_when: false

- name: Set Arch package manager fact
  ansible.builtin.set_fact:
    arch_package_manager: "{{ arch_pkg_mgr.stdout }}"

- name: Install system prerequisites via yay
  yay:
    name: "{{ system_prereqs }}"
    state: present
  when: arch_package_manager == "yay"

- name: Install system prerequisites via pacman
  community.general.pacman:
    name: "{{ system_prereqs }}"
    state: present
  become: true
  when: arch_package_manager == "pacman"
