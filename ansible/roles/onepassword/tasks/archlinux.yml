---
# Arch Linux-specific 1Password CLI installation

- name: Detect if yay is available
  ansible.builtin.shell: command -v yay >/dev/null 2>&1 && echo "yay" || echo "none"
  register: arch_pkg_mgr
  changed_when: false

- name: Install 1Password CLI via yay
  yay:
    name: 1password-cli
    state: present
  when: arch_pkg_mgr.stdout == "yay"

- name: Fail if yay is not available
  ansible.builtin.fail:
    msg: "1Password CLI requires yay to be installed on Arch Linux"
  when: arch_pkg_mgr.stdout == "none"
